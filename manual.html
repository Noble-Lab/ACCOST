<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head>
<meta content="text/html; charset=ISO-8859-1" http-equiv="content-type"><title>ACCOST manual</title></head><body>
<h2>ACCOST Manual</h2>

<h3>Description</h3>

ACCOST assigns statistical significance to differences in contact counts in Hi-C experiments. ACCOST uses a negative

binomial to model the contact counts, and pools contacts at the same genomic distance to aid in estimating the mean
and variance of the data.<br>
<br>

Initial processing of Hi-C data (mapping, filtering, binning, and normalization) is beyond the scope of this tool.<br>

ACCOST can be run in two modes: without replicates, when only a single (biological) replicate is available, and with
replicates, in cases where multiple biological replicates have been performed.<br>
<br>

<h3>Usage</h3>


<span style="font-weight: bold;">
Single-sample mode:</span><br>

<br>
<pre>accost.py [options] &lt;bin size&gt; &lt;hi-c 1&gt; &lt;bias 1&gt; &lt;hi-c 2&gt; &lt;bias 2&gt;</pre><br><span style="font-weight: bold;">

Replicate mode:</span><br>
<br>
<pre>accost.py [options] &lt;bin size&gt; &lt;filename input file&gt;</pre><br>

<h3>Input format</h3>

<span style="font-family: monospace">&lt;hi-c 1&gt;</span> and
<span style="font-family: monospace">&lt;hi-c 2&gt;</span> are <b>raw</b> Hi-C contact count files in
tab-delimited format, with tab-delimited colums
<span style="font-family: monospace">&lt;chr1&gt; &lt;mid1&gt; &lt;chr2&gt; &lt;mid2&gt; &lt;# reads&gt;</span>
<br>

<br>

E.g.:<br>

<br>
<div style="font-family: monospace">
chr6&nbsp;&nbsp;&nbsp; 225000&nbsp;&nbsp;&nbsp; chr11&nbsp;&nbsp;&nbsp; 795000&nbsp;&nbsp;&nbsp; 1<br>

chr5&nbsp;&nbsp;&nbsp; 425000&nbsp;&nbsp;&nbsp; chr8&nbsp;&nbsp;&nbsp; 1195000&nbsp;&nbsp;&nbsp; 1<br>

chr5&nbsp;&nbsp;&nbsp; 425000&nbsp;&nbsp;&nbsp; chr8&nbsp;&nbsp;&nbsp; 1105000&nbsp;&nbsp;&nbsp; 1<br>

chr5&nbsp;&nbsp;&nbsp; 425000&nbsp;&nbsp;&nbsp; chr8&nbsp;&nbsp;&nbsp; 1115000&nbsp;&nbsp;&nbsp; 1<br>

chr5&nbsp;&nbsp;&nbsp; 425000&nbsp;&nbsp;&nbsp; chr8&nbsp;&nbsp;&nbsp; 1145000&nbsp;&nbsp;&nbsp; 2<br>

chr5&nbsp;&nbsp;&nbsp; 425000&nbsp;&nbsp;&nbsp; chr8&nbsp;&nbsp;&nbsp; 1155000&nbsp;&nbsp;&nbsp; 3<br>

chr2&nbsp;&nbsp;&nbsp; 685000&nbsp;&nbsp;&nbsp; chr14&nbsp;&nbsp;&nbsp; 2355000&nbsp;&nbsp;&nbsp; 1<br>
</div>
<br>

The data do not need to include zeros, and do not have to be sorted. Note that the data must be raw; non-integer counts will produce an error.<br>

<br>

<span style="font-family: monospace">&lt;bias 1&gt;</span> and
<span style="font-family: monospace">&lt;bias 2&gt;</span> are normalization biases (e.g. from
ICE normalization), and are a single column of floats such that:<br>

<br>

<span style="font-family: monospace">normalized_i,j = raw_i,j / (bias_i * bias_j)</span><br>

<br>
<span style="font-weight: bold;">Replicate mode:</span><br>
<br>

In replicate mode, filenames can be supplied as a file with the following format:<br>

<br>
<div style="font-family: monospace">
&lt;hi-c&gt; &lt;bias&gt; &lt;id 1&gt;<br>

&lt;hi-c&gt; &lt;bias&gt; &lt;id 1&gt;<br>

&lt;hi-c&gt; &lt;bias&gt; &lt;id 2&gt;<br>

&lt;hi-c&gt; &lt;bias&gt; &lt;id 2&gt;<br>
</div>
<br>

<span style="font-family: monospace">&lt;hi-c&gt;</span> and
<span style="font-family: monospace">&lt;bias&gt;</span> are file names, with the files in the format described above, separated by whitespace.<br>

<br>

<span style="font-family: monospace">&lt;id 1&gt;</span>
and
<span style="font-family: monospace">&lt;id 2&gt;</span>
can be any string (e.g. 1 and 2, or A and B, or WT and KO), but only two classes are supported.<br>
<br>

<span style="font-family: monospace">&lt;bin size&gt;</span> is an integer denoting the bin width, and is required.<br>
<h3>Output format</h3>

<p>Running <span style="font-family: monospace">ACCOST.py</span> will output two files:
<span style="font-family: monospace">&lt;output-prefix&gt;_ln_pvals.txt</span>
(containing i,j indices and natural log of p-values) and
<span style="font-family: monospace">stats.csv</span>
(containing additional statistics useful for debugging).
A more useful output file can be created by running<br>
<br>
<span style="font-family: monospace">annotate_pvals.py &lt;output-prefix&gt;_ln_pvals.txt binfile outputfile</span><br>
<br>
Input to <span style="font-family: monospace">annotate_pvals.py</span>
is the natural log pval file, the bin file (see format description below), and an output file name. This will produce
output of the form:
</p>

<div style="font-family: monospace">
i   j   chr1   mid1   chr2   mid2   dist   ln_pval   log10_pval   pval<br>
0   1   chr1   5000   chr1   15000   1   -13.708   -5.953   1.114e-06<br>
0   2   chr1   5000   chr1   25000   2   -11.676   -5.071   8.497e-06<br>
0   3   chr1   5000   chr1   35000   3   -2.251   -0.978   1.053e-01<br>
0   9   chr1   5000   chr1   95000   9   -6.114   -2.655   2.212e-03<br>
0   10   chr1   5000   chr1   105000   10   -4.342   -1.886   1.300e-02<br>
</div>

<p>
The bin file required is columns 2-4 of the output file (without a header line), i.e.
</p>

<div style="font-family: monospace">
chr1    5000    chr1    15000<br>
chr1    5000    chr1    25000<br>
chr1    5000    chr1    35000<br>
chr1    5000    chr1    95000<br>
chr1    5000    chr1    105000<br>
</div>



<h3>
Options</h3>


<span style="font-family: monospace">--distances &lt;file&gt;</span><br>
&nbsp;&nbsp;&nbsp; pre-calculated distance file. If this is not
specified, it will be calculated, but can be loaded to speed up
calculations <span style="font-family: monospace">(see precalculate-lengths.py)</span> (default: None) <br>
<span style="font-family: monospace">--output-prefix &lt;string&gt;</span><br>
&nbsp;&nbsp;&nbsp; Prefix for output files<br>
<span style="font-family: monospace">--map-thresh &lt;float&gt;</span><br>
&nbsp;&nbsp;&nbsp; Mappability threshold (default: 0.25)<br>
<span style="font-family: monospace">--min-dist &lt;int&gt;</span><br>
&nbsp;&nbsp;&nbsp; Minimum distance to calculate P-values (default:???)<br>
<span style="font-family: monospace">--max-dist &lt;int&gt;</span><br>
&nbsp;&nbsp;&nbsp; Maximum distance to calculate P-values (default: None)<br>
<span style="font-family: monospace">--min-percentile &lt;float&gt;</span><br>
&nbsp;&nbsp;&nbsp; Percentile above which to calculate P-values (default: 0.8)<br>
<span style="font-family: monospace">--chrom-sizes &lt;file&gt;</span><br>
&nbsp;&nbsp;&nbsp; Chromosome sizes file (default: hg19 sizes)<br>
<span style="font-family: monospace">--output-matrix &lt;boolean&gt;</span><br>
&nbsp;&nbsp;&nbsp; Whether to output the full, dense matrix of P-values
(rather than just those passing a threshold) (default: F)<br>
<span style="font-family: monospace">--output-p-thresh &lt;float&gt;</span><br>
<span style="font-family: monospace">--output-q-thresh &lt;float&gt;</span><br>
&nbsp;&nbsp;&nbsp; Report loci for which the P-value or Q-value is
below this threshold. One of these must be specified, but it can be 1.0
to output everything.<br>
<br><br>

</body></html>
